<!DOCTYPE html>
<html>
<head>
    
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    
    <script>
        L_NO_TOUCH = false;
        L_DISABLE_3D = false;
    </script>
    
    <style>html, body {width: 100%; height: 100%; margin: 0; padding: 0;}</style>
    <style>#map {position:absolute; top:0; bottom:0; right:0; left:0;}</style>

    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.6.0/dist/leaflet.js"></script>
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.min.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.6.0/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css"/>
            
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <style>
        #map {
            position: relative;
            width: 100.0%;
            height: 100.0%;
            left: 0.0%;
            top: 0.0%;
        }

        #updated {
            width: 100%;
            text-align: center;
            position: fixed;
            top: 0%;
            padding-top: 10px;
            padding-bottom: 10px;

            font-family: NanumGothic;
            font-style: normal;
            font-weight: bold;
            font-size: 16px;
            color: #000000;
            background: #FF7500;

            z-index: 9999;
        }

        #copied {
            width: 300px;
            height: 50px;
            text-align: center;
            position: fixed;
            bottom: 10%;
            left: 50%;
            transform: translate(-50%, 0%);

            font-family: NanumGothic;
            font-style: normal;
            font-weight: bold;
            font-size: 16px;
            line-height: 50px;
            color: #000000;
            background: #FF7500;
            border-radius: 10px;

            z-index: 9999;
        }
    </style>
        
</head>

<script>

    var map
    var tile_layer
    var marker
    var icon
    var popup
    var html

    var tourzy_bike = 



[{"car":"TZ0044","lock":"열림","fuel":10,"lock_fuel":96,"lat":"35.15171290138638","lng":"129.0655533452351","lastest":45138.66645833333,"address":"대한민국 부산광역시 부산진구 전포동 362-26","etc":"미잠금"},{"car":"TZ0060","lock":"열림","fuel":41,"lock_fuel":95,"lat":"35.17617075808069","lng":"129.1727682496187","lastest":45138.66636574074,"address":"대한민국 부산광역시 해운대구 좌동 1288","etc":"미잠금"},{"car":"TZ0156","lock":"열림","fuel":62,"lock_fuel":98,"lat":"35.16011540397319","lng":"129.16062676982207","lastest":45138.66712962963,"address":"대한민국 부산광역시 해운대구 해운대해변로265번길 7","etc":"미잠금"},{"car":"TZ0201","lock":"잠김","fuel":13,"lock_fuel":97,"lat":"35.13550753497417","lng":"129.10096043481076","lastest":45138.66686342593,"address":"대한민국 부산광역시 남구 용소로 21","etc":"배터리"},{"car":"TZ0121","lock":"잠김","fuel":0,"lock_fuel":88,"lat":"35.169344505205096","lng":"129.17592825663996","lastest":45138.66505787037,"address":"대한민국 부산광역시 해운대구 해운대로 802","etc":"배터리"},{"car":"TZ0135","lock":"잠김","fuel":0,"lock_fuel":81,"lat":"35.12886312375663","lng":"129.1130366703833","lastest":45138.66048611111,"address":"대한민국 부산광역시 남구 용호동 176-30","etc":"배터리"},{"car":"TZ0209","lock":"잠김","fuel":0,"lock_fuel":90,"lat":"35.163046840036145","lng":"129.1441961110223","lastest":45138.66196759259,"address":"대한민국 부산광역시 해운대구 우동 1005-23","etc":"배터리"},{"car":"TZ0266","lock":"잠김","fuel":0,"lock_fuel":73,"lat":"35.16653894313402","lng":"129.11649095762976","lastest":45138.66702546296,"address":"대한민국 부산광역시 수영구 광안동 75-4번지 402호","etc":"배터리"},{"car":"TZ0338","lock":"잠김","fuel":0,"lock_fuel":88,"lat":"35.168806277734255","lng":"129.16826004915902","lastest":45138.6674537037,"address":"대한민국 부산광역시 해운대구 중동 1339","etc":"배터리"},{"car":"TZ0354","lock":"잠김","fuel":0,"lock_fuel":60,"lat":"35.16140048105692","lng":"129.155372476176","lastest":45138.66672453703,"address":"대한민국 부산광역시 해운대구 우동 641-6","etc":"배터리"},{"car":"TZ0427","lock":"잠김","fuel":0,"lock_fuel":57,"lat":"35.148044193776286","lng":"129.06616400829503","lastest":45138.66545138889,"address":"대한민국 부산광역시 남구 문현동 704-4","etc":"배터리"},{"car":"TZ0016","lock":"잠김","fuel":10,"lock_fuel":96,"lat":"35.137953250944676","lng":"129.0680525580582","lastest":45138.66456018519,"address":"대한민국 부산광역시 남구 문현동 377-25","etc":"배터리"},{"car":"TZ0025","lock":"잠김","fuel":10,"lock_fuel":95,"lat":"35.15102758602414","lng":"129.11284433387243","lastest":45138.66109953704,"address":"대한민국 부산광역시 수영구 광안동 181-21","etc":"배터리"},{"car":"TZ0109","lock":"잠김","fuel":10,"lock_fuel":97,"lat":"35.20476365238545","lng":"129.11815837619898","lastest":45138.66442129629,"address":"대한민국 부산광역시 일동아파트","etc":"배터리"},{"car":"TZ0141","lock":"잠김","fuel":10,"lock_fuel":97,"lat":"35.148643001551534","lng":"129.11500153504394","lastest":45138.6655787037,"address":"대한민국 부산광역시 수영구 광안동 204-17","etc":"배터리"},{"car":"TZ0172","lock":"잠김","fuel":10,"lock_fuel":96,"lat":"35.23008893770811","lng":"129.08844540264505","lastest":45138.66334490741,"address":"대한민국 부산광역시 금정구 장전동 293-184","etc":"배터리"},{"car":"TZ0178","lock":"잠김","fuel":10,"lock_fuel":97,"lat":"35.15338093911444","lng":"129.11290129746854","lastest":45138.661875,"address":"대한민국 부산광역시 수영구 광안동 373-169","etc":"배터리"},{"car":"TZ0248","lock":"잠김","fuel":10,"lock_fuel":97,"lat":"35.13786836216906","lng":"129.06774359719412","lastest":45138.66111111111,"address":"대한민국 부산광역시 남구 문현동 652-2","etc":"배터리"},{"car":"TZ0262","lock":"잠김","fuel":10,"lock_fuel":97,"lat":"35.16749579582985","lng":"129.1146881224521","lastest":45138.66773148148,"address":"대한민국 부산광역시 수영구 광안동 1071-1","etc":"배터리"},{"car":"TZ0275","lock":"잠김","fuel":10,"lock_fuel":96,"lat":"35.16097417927841","lng":"129.12983767117424","lastest":45138.66190972222,"address":"대한민국 부산광역시 수영구 민락동 1-24","etc":"배터리"},{"car":"TZ0312","lock":"잠김","fuel":10,"lock_fuel":97,"lat":"35.16652764130166","lng":"129.13002054014672","lastest":45138.66694444444,"address":"대한민국 부산광역시 해운대구 우동 센텀남대로","etc":"배터리"},{"car":"TZ0314","lock":"잠김","fuel":10,"lock_fuel":96,"lat":"35.168393376349066","lng":"129.17637055183187","lastest":45138.66128472222,"address":"대한민국 부산광역시 해운대구 양운로 55","etc":"배터리"},{"car":"TZ0343","lock":"잠김","fuel":10,"lock_fuel":96,"lat":"35.160663804751316","lng":"129.12970272522256","lastest":45138.6652662037,"address":"대한민국 부산광역시 수영구 민락동 108-4","etc":"배터리"},{"car":"TZ0364","lock":"잠김","fuel":10,"lock_fuel":96,"lat":"35.14639449397669","lng":"129.11226944348778","lastest":45138.66700231482,"address":"대한민국 부산광역시 수영구 남천동 7-2","etc":"배터리"},{"car":"TZ0436","lock":"잠김","fuel":10,"lock_fuel":96,"lat":"35.16348819577641","lng":"129.1376409727131","lastest":45138.66744212963,"address":"대한민국 부산광역시 해운대구 우동 1398","etc":"배터리"},{"car":"TZ0456","lock":"잠김","fuel":10,"lock_fuel":97,"lat":"35.1573952564084","lng":"129.06010800860096","lastest":45138.66494212963,"address":"대한민국 부산광역시 부산진구 부전동 156-69","etc":"배터리"},{"car":"TZ0484","lock":"잠김","fuel":10,"lock_fuel":97,"lat":"35.1888332883094","lng":"129.0769082461971","lastest":45138.66561342592,"address":"대한민국 부산광역시 연제구 거제동 23-11","etc":"배터리"},{"car":"TZ0488","lock":"잠김","fuel":10,"lock_fuel":96,"lat":"35.168197097514195","lng":"129.12010204108032","lastest":45138.66337962963,"address":"대한민국 부산광역시 수영구 민락동 186-4","etc":"배터리"},{"car":"TZ0357","lock":"잠김","fuel":12,"lock_fuel":98,"lat":"35.1613028924135","lng":"129.17133456135073","lastest":45138.6682175926,"address":"대한민국 부산광역시 해운대구 중동 941-7","etc":"배터리"},{"car":"TZ0281","lock":"잠김","fuel":13,"lock_fuel":97,"lat":"35.18134683524384","lng":"129.06956199590334","lastest":45138.66303240741,"address":"대한민국 부산광역시 연제구 거제동 670-16","etc":"배터리"},{"car":"TZ0393","lock":"잠김","fuel":14,"lock_fuel":98,"lat":"35.140614368096934","lng":"129.1060522474083","lastest":45138.66449074074,"address":"대한민국 부산광역시 수영구 남천제1동 340-1","etc":"배터리"},{"car":"TZ0191","lock":"잠김","fuel":15,"lock_fuel":96,"lat":"35.151095910185056","lng":"129.11561434474493","lastest":45138.66598379629,"address":"대한민국 부산광역시 수영구 광안동 199-11","etc":"배터리"},{"car":"TZ0384","lock":"잠김","fuel":15,"lock_fuel":97,"lat":"35.16108668379906","lng":"129.0562676154157","lastest":45138.66702546296,"address":"대한민국 부산광역시 부산진구 새싹로 39-1","etc":"배터리"},{"car":"TZ0475","lock":"잠김","fuel":15,"lock_fuel":96,"lat":"35.196751155916964","lng":"129.07849126852088","lastest":45138.66452546296,"address":"대한민국 부산광역시 연제구 거제동 114-2","etc":"배터리"},{"car":"TZ0008","lock":"잠김","fuel":16,"lock_fuel":97,"lat":"35.14482439864815","lng":"129.06302743566204","lastest":45138.66252314814,"address":"대한민국 부산광역시 부산진구 범천동 842-8","etc":"배터리"},{"car":"TZ0307","lock":"잠김","fuel":16,"lock_fuel":97,"lat":"35.167702845469556","lng":"129.16248819193248","lastest":45138.66349537037,"address":"대한민국 부산광역시 해운대구 우동 198-13","etc":"배터리"},{"car":"TZ0323","lock":"잠김","fuel":16,"lock_fuel":97,"lat":"35.170354244258405","lng":"129.13731173039812","lastest":45138.66142361111,"address":"대한민국 부산광역시 해운대구 우동 해운대로 365","etc":"배터리"},{"car":"TZ0426","lock":"잠김","fuel":16,"lock_fuel":95,"lat":"35.147507702397164","lng":"129.0596280913147","lastest":45138.66320601852,"address":"대한민국 부산광역시 부산진구 황령대로 2","etc":"배터리"},{"car":"TZ0227","lock":"잠김","fuel":17,"lock_fuel":96,"lat":"35.149325993244915","lng":"129.11267635697163","lastest":45138.6674537037,"address":"대한민국 부산광역시 수영구 남천동 26-7","etc":"배터리"},{"car":"TZ0094","lock":"잠김","fuel":18,"lock_fuel":96,"lat":"35.13329821709175","lng":"129.09979594043935","lastest":45138.66604166666,"address":"대한민국 부산광역시 남구 대연동 544-1","etc":"배터리"},{"car":"TZ0112","lock":"잠김","fuel":18,"lock_fuel":96,"lat":"35.1605484405036","lng":"129.16767084713928","lastest":45138.66349537037,"address":"대한민국 부산광역시 해운대구 중동 1137-7","etc":"배터리"},{"car":"TZ0114","lock":"잠김","fuel":18,"lock_fuel":97,"lat":"35.15042378431204","lng":"129.11470190613184","lastest":45138.66440972222,"address":"대한민국 부산광역시 광일맨션","etc":"배터리"},{"car":"TZ0122","lock":"잠김","fuel":18,"lock_fuel":97,"lat":"35.13161669963593","lng":"129.09915921577428","lastest":45138.66209490741,"address":"대한민국 부산광역시 남구 대연동 572-35","etc":"배터리"},{"car":"TZ0152","lock":"잠김","fuel":18,"lock_fuel":96,"lat":"35.16048682244796","lng":"129.0645076733315","lastest":45138.66388888889,"address":"대한민국 부산광역시 부산진구 전포동 635-1","etc":"배터리"},{"car":"TZ0168","lock":"잠김","fuel":18,"lock_fuel":97,"lat":"35.16348920087193","lng":"129.14471886986226","lastest":45138.66491898148,"address":"대한민국 부산광역시 해운대구 우동 1180-1","etc":"배터리"},{"car":"TZ0181","lock":"잠김","fuel":18,"lock_fuel":98,"lat":"35.13489961244083","lng":"129.11220320545064","lastest":45138.66341435185,"address":"2층, W스퀘어 954번지 용호동 남구 부산광역시 대한민국","etc":"배터리"},{"car":"TZ0188","lock":"잠김","fuel":18,"lock_fuel":96,"lat":"35.155239648901066","lng":"129.1242214743184","lastest":45138.66509259259,"address":"대한민국 부산광역시 수영구 민락동 181-134","etc":"배터리"},{"car":"TZ0241","lock":"잠김","fuel":18,"lock_fuel":96,"lat":"35.16067345223753","lng":"129.14331797513776","lastest":45138.66304398148,"address":"대한민국 부산광역시 해운대구 해운대해변로 99","etc":"배터리"},{"car":"TZ0264","lock":"잠김","fuel":18,"lock_fuel":97,"lat":"35.158695711711694","lng":"129.13295963747427","lastest":45138.66763888889,"address":"대한민국 부산광역시 수영구 민락동 108-17","etc":"배터리"},{"car":"TZ0318","lock":"잠김","fuel":18,"lock_fuel":97,"lat":"35.13067495657968","lng":"129.0946965534255","lastest":45138.6655787037,"address":"대한민국 부산광역시 대연동 867-35번지 1층 남구 부산광역시 KR","etc":"배터리"},{"car":"TZ0360","lock":"잠김","fuel":18,"lock_fuel":97,"lat":"35.172012973570006","lng":"129.1718920389522","lastest":45138.66621527778,"address":"대한민국 부산광역시 해운대구 중동 184-6","etc":"배터리"},{"car":"TZ0380","lock":"잠김","fuel":18,"lock_fuel":97,"lat":"35.151880803268156","lng":"129.11161670015562","lastest":45138.66287037037,"address":"대한민국 부산광역시 수영구 광안동 345-2","etc":"배터리"},{"car":"TZ0390","lock":"잠김","fuel":18,"lock_fuel":96,"lat":"35.126650704839335","lng":"129.09009415856238","lastest":45138.66424768518,"address":"대한민국 부산광역시 남구 석포로 102","etc":"배터리"},{"car":"TZ0476","lock":"잠김","fuel":18,"lock_fuel":97,"lat":"35.13631130492117","lng":"129.099947896397","lastest":45138.665625,"address":"대한민국 부산광역시 남구 용소로8번길 7","etc":"배터리"},{"car":"TZ0055","lock":"잠김","fuel":19,"lock_fuel":97,"lat":"35.16848449012843","lng":"129.17586250476597","lastest":45138.66228009259,"address":"대한민국 부산광역시 해운대구 좌동 1473-6","etc":"배터리"},{"car":"TZ0074","lock":"잠김","fuel":19,"lock_fuel":97,"lat":"35.160429952135125","lng":"129.12915409125358","lastest":45138.66518518519,"address":"대한민국 부산광역시 수영구 민락동 66","etc":"배터리"},{"car":"TZ0107","lock":"잠김","fuel":19,"lock_fuel":97,"lat":"35.15955630876566","lng":"129.1087384416591","lastest":45138.66237268518,"address":"대한민국 부산광역시 수영구 광안동 536-135번지","etc":"배터리"},{"car":"TZ0180","lock":"잠김","fuel":19,"lock_fuel":96,"lat":"35.19036811421264","lng":"129.1024540807042","lastest":45138.66585648148,"address":"대한민국 부산광역시 연제구 연산동 2042-1","etc":"배터리"},{"car":"TZ0183","lock":"잠김","fuel":19,"lock_fuel":97,"lat":"35.13371823928577","lng":"129.11137111713268","lastest":45138.66493055555,"address":"대한민국 부산광역시 용호동 954 1047호","etc":"배터리"},{"car":"TZ0216","lock":"잠김","fuel":19,"lock_fuel":97,"lat":"35.161024678423146","lng":"129.16809984999014","lastest":45138.663125,"address":"대한민국 부산광역시 해운대구 중제1동 1114-1","etc":"배터리"},{"car":"TZ0218","lock":"잠김","fuel":19,"lock_fuel":98,"lat":"35.15114054194783","lng":"129.1111957600799","lastest":45138.6612037037,"address":"대한민국 부산광역시 수영구 광안제4동 330-22","etc":"배터리"},{"car":"TZ0232","lock":"잠김","fuel":19,"lock_fuel":96,"lat":"35.13852768195166","lng":"129.1105216070969","lastest":45138.66214120371,"address":"대한민국 부산광역시 수영구 남천동 568","etc":"배터리"},{"car":"TZ0402","lock":"잠김","fuel":19,"lock_fuel":97,"lat":"35.15808115240895","lng":"129.1167527050974","lastest":45138.66738425926,"address":"대한민국 부산광역시 수영구 광안동 147-14","etc":"배터리"}]



    // 주소 복사
    function copyToClipboard(val) {
        const t = document.createElement("textarea");
        document.body.appendChild(t);
        t.value = val;
        t.select();
        document.execCommand('copy');
        document.body.removeChild(t);
    }

    function copy(addr, carnum) {

        var jsonIdx = tourzy_bike.findIndex(function(key) {return key["car"] === carnum});
        
        var idx = JSON.stringify(jsonIdx);

        // console.log('idx : ' + idx)

        const onlongclick = ($target, duration, callback) => {

            $target.onmousedown = () => {
                const timer = setTimeout(callback, duration);

                $target.onmouseup = () => {
                clearTimeout(timer);
                };
            };  

            $target.ontouchstart = () => {
                const timer = setTimeout(callback, duration);

                $target.ontouchend = () => {
                clearTimeout(timer);
                };
            };  
        }

        // 코드예시
        const $target = document.querySelector('#html');

        onlongclick($target, 300, () => {

            alert('차량 번호 : ' + carnum + ' 작업을 완료했습니다.');
        });
        
        copyToClipboard(addr);

        $("#copied").show();

        self.setTimeout("hideDiv()", 2000);
    }
    
    $(document).ready(function () {

        $("#copied").hide();
    });
    // 주소 복사

    function hideDiv () {
        
        $("#copied").hide();
    }

    function mapLoad () {
        
        // $("#folium-map").html(JSON.stringify(XLSX.utils.sheet_to_json (sheet)));

        // console.log(JSON.stringify(XLSX.utils.sheet_to_json(sheet)))

        map = L.map("map", {
            center: [35.16380454089401, 129.1326448135078],
            crs: L.CRS.EPSG3857,
            zoom: 11,
            zoomControl: true,
            preferCanvas: false,
        });

        tile_layer = L.tileLayer(
            "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
            {"attribution": "Data by \u0026copy; \u003ca href=\"http://openstreetmap.org\"\u003eOpenStreetMap\u003c/a\u003e, under \u003ca href=\"http://www.openstreetmap.org/copyright\"\u003eODbL\u003c/a\u003e.", "detectRetina": false, "maxNativeZoom": 18, "maxZoom": 18, "minZoom": 0, "noWrap": false, "opacity": 1, "subdomains": "abc", "tms": false}
        ).addTo(map);

        for (let i = 0; i < tourzy_bike.length; i++) {

            // console.log(`${i} car:${tourzy_bike[i].car}, lat:${tourzy_bike[i].lat}, lng:${tourzy_bike[i].lng}`)

            // 시작
            marker = L.marker(
                [tourzy_bike[i].lat, tourzy_bike[i].lng],
                {}
            ).addTo(map);

            var icon_color = ''
            var icon_img = ''

            if (tourzy_bike[i].fuel < 15) {

                icon_color = 'red'

            } else {

                icon_color = 'orange'
            }

            if (tourzy_bike[i].lock == '열림') {

                icon_img = 'ban-circle'

            } else {

                if (tourzy_bike[i].etc == 'GPS' || tourzy_bike[i].etc == '파손' || tourzy_bike[i].etc == '회수') {

                    icon_img = 'plus-sign'

                } else if (tourzy_bike[i].etc == '이탈') {

                    icon_img = 'refresh'
                    
                } else {

                    icon_img = 'flash'
                }
            }
        
            icon = L.AwesomeMarkers.icon(
                {"extraClasses": "fa-rotate-0", "icon": icon_img, "iconColor": "white", "markerColor": icon_color, "prefix": "glyphicon"}
            );
            marker.setIcon(icon);
        
            popup = L.popup({"maxWidth": "100%"});
            html = $(`<div id="html" onclick="copy('${tourzy_bike[i].address.replace("대한민국 ", "")}', '${tourzy_bike[i].car}')"; style="width: 100.0%; height: 100.0%;">${tourzy_bike[i].car}<br /><div id="html" style="width: 100.0%; height: 100.0%;">${tourzy_bike[i].fuel}%</div><br /><div id="html" style="width: 100.0%; height: 100.0%;">${tourzy_bike[i].etc}</div></div>`)[0];
            popup.setContent(html);
            
            marker.bindPopup(popup);
            // 끝
        }
    }

    window.onload = function () {
        
        mapLoad ()
    }

</script>

<body>

    <div id="copied">주소가 복사되었습니다.</div>

    <div id="updated">UPDATED 2023.07.31. 16:00 총 63대
        <br/>
        밴 - 잠금 열린 차량 (3대)
        <br/>
        플러스 - 회수 후 정비가 필요한 차량 (0대)
        <br/>
        리프레쉬 - 재배치가 필요한 차량 (0대)
        <br/>
        번개 - 배터리 부족 빨간색 15% 이하, 주황색 15% 이상 30% 이하 (60대)
    </div>
    
    <div class="folium-map" id="map"></div>
        
</body>

</html>